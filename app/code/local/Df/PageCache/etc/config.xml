<?xml version='1.0'?>
<config>
	<modules>
		<Df_PageCache>
			<version>1.0.0</version>
			<author>Дмитрий Федюк</author>
		</Df_PageCache>
	</modules>
	<df>
		<admin>
			<notifiers>
				<page_cache>Df_PageCache_Model_Admin_Notifier</page_cache>
			</notifiers>
		</admin>
		<features>
			<df-full-page-caching>
				<module>df_pagecache</module>
				<title>Полностраничное кэширование</title>
				<url>http://magento-forum.ru/forum/180/</url>
			</df-full-page-caching>
		</features>
	</df>
	<global>
		<blocks><df_pagecache><class>Df_PageCache_Block</class></df_pagecache></blocks>
		<helpers><df_pagecache><class>Df_PageCache_Helper</class></df_pagecache></helpers>
		<models>
			<df_pagecache>
				<class>Df_PageCache_Model</class>
				<resourceModel>df_pagecache_resource</resourceModel>
			</df_pagecache>
			<df_pagecache_resource>
				<class>Df_PageCache_Model_Resource</class>
			</df_pagecache_resource>
		</models>
		<cache>
			<types>
				<full_page translate='label,description' module='df_pagecache'>
					<label>Полностраничное кэширование</label>
					<description>Кэширует страницы витрины и административной части полностью. Ускоряет загрузку страниц в 30 раз. Часть Российской сборки Magento.</description>
					<tags>FPC</tags>
				</full_page>
			</types>
		</cache>
		<ignore_user_agents>
			<cache_crawler>MagentoCrawler</cache_crawler>
		</ignore_user_agents>
		<widget>
			<related_cache_types>
				<full_page/>
			</related_cache_types>
		</widget>
	</global>
	<adminhtml>
		<events>
			<catalogrule_after_apply>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>cleanCache</method>
					</df_pagecache>
				</observers>
			</catalogrule_after_apply>
			<clean_media_cache_after>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>cleanCache</method>
					</df_pagecache>
				</observers>
			</clean_media_cache_after>
			<clean_catalog_images_cache_after>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>cleanCache</method>
					</df_pagecache>
				</observers>
			</clean_catalog_images_cache_after>
			<controller_action_postdispatch_adminhtml_system_config_save>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>invalidateCache</method>
					</df_pagecache>
				</observers>
			</controller_action_postdispatch_adminhtml_system_config_save>
			<model_delete_commit_after>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>validateDataDelete</method>
					</df_pagecache>
				</observers>
			</model_delete_commit_after>
			<model_save_commit_after>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>validateDataChanges</method>
					</df_pagecache>
				</observers>
			</model_save_commit_after>
		</events>
	</adminhtml>
	<frontend>
		<layout>
			<updates>
				<df_pagecache><file>df/pagecache.xml</file></df_pagecache>
			</updates>
		</layout>
		<events>
			<controller_action_predispatch>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>processPreDispatch</method>
					</df_pagecache>
				</observers>
			</controller_action_predispatch>
			<controller_action_postdispatch_catalog_product_view>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>checkProductState</method>
					</df_pagecache>
				</observers>
			</controller_action_postdispatch_catalog_product_view>
			<controller_action_postdispatch_catalog_category_view>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>checkCategoryState</method>
					</df_pagecache>
				</observers>
			</controller_action_postdispatch_catalog_category_view>
			<controller_front_send_response_after>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>cacheResponse</method>
					</df_pagecache>
				</observers>
			</controller_front_send_response_after>
			<model_load_after>
				<observers>
					<df_pagecache>
						<type>singleton</type>
						<class>df_pagecache/observer</class>
						<method>registerModelTag</method>
					</df_pagecache>
				</observers>
			</model_load_after>
		</events>
		<cache>
			<requests>
				<!--
					Supported definitions:
					<module_front_name>processor_model</module_front_name> - all module urls
					<module_front_name><controller>processor_model</controller></module_front_name> - all module controller actions
					<module_front_name><controller><action>processor_model</action></controller></module_front_name> - specific action
				 -->
				<cms>df_pagecache/processor_default</cms>
				<catalog><category><view>df_pagecache/processor_category</view></category></catalog>
				<catalog><product><view>df_pagecache/processor_default</view></product></catalog>
			</requests>
		</cache>
	</frontend>
	<default>
		<df_speed>
			<page_cache>
				<lifetime>10080</lifetime>
				<allowed_depth>3</allowed_depth>
				<multicurrency>1</multicurrency>
				<auto_crawling__enabled>1</auto_crawling__enabled>
				<auto_crawling__time>3,0,0</auto_crawling__time>
				<auto_crawling__frequency>D</auto_crawling__frequency>
				<auto_crawling__num_threads>1</auto_crawling__num_threads>
				<auto_crawling__multicurrency>1</auto_crawling__multicurrency>
			</page_cache>
		</df_speed>
	</default>
	<crontab>
		<jobs>
			<df_page_cache_crawler>
				<!--
				<schedule>
					<cron_expr>*/1 * * * *</cron_expr>
				</schedule>
				-->
				<run>
					<model>df_pagecache/crawler::crawl</model>
				</run>
			</df_page_cache_crawler>
		</jobs>
	</crontab>
</config>
